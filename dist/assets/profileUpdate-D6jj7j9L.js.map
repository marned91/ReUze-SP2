{"version":3,"file":"profileUpdate-D6jj7j9L.js","sources":["../../src/script/router/views/profileUpdate.mjs"],"sourcesContent":["import { authGuard } from '../../utils/authGuard.mjs'\nimport { fetchProfileData, updateProfileData } from '../../api/profile.mjs'\nimport { handleAlert } from '../../global/handleAlerts.mjs'\nimport {\n  showSkeletonLoader,\n  hideSkeletonLoader,\n} from '../../utils/skeletonLoader.mjs'\n\nauthGuard()\n\n/**\n * Handles the profile update process for the user.\n *\n * This function fetches the current profile data of the user from the server using the `fetchProfileData` function,\n * populates the profile form with existing data, and allows the user to update their bio and profile image. Upon form\n * submission, it sends the updated data to the server and handles both success and error cases, displaying appropriate\n * alerts and updating the page accordingly.\n *\n * @async\n * @returns {void} - This function does not return any value.\n *\n * @example\n * // This will handle the profile update process for the user.\n * handleProfileUpdate();\n */\nasync function handleProfileUpdate() {\n  const userInfo = JSON.parse(localStorage.getItem('user'))\n  const username = userInfo?.name\n\n  const updateProfileContainer = document.getElementById(\n    'profile-edit-container',\n  )\n  updateProfileContainer.classList.add('hidden')\n\n  const profileImageContainer = document.getElementById('profile-image')\n  const bioField = document.getElementById('bio')\n  const imageUrlField = document.getElementById('image-url')\n\n  try {\n    showSkeletonLoader()\n    const profile = await fetchProfileData(username)\n\n    bioField.value = profile?.bio || 'No BIO added yet'\n\n    if (profile?.avatar?.url) {\n      const profileImage = document.createElement('img')\n      profileImage.src = profile.avatar.url\n      profileImage.alt = profile.avatar.alt || 'Profile Image'\n      profileImage.classList.add('w-full', 'max-h-[500px]', 'object-cover')\n      profileImageContainer.appendChild(profileImage)\n\n      imageUrlField.value = profile.avatar.url\n    }\n\n    updateProfileContainer.classList.remove('hidden')\n\n    const form = document.getElementById('profile-edit-form')\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault()\n\n      const updatedData = {\n        bio: bioField.value,\n        avatar: {\n          url: imageUrlField.value,\n          alt: 'Profile Image',\n        },\n      }\n\n      const fieldset = form.querySelector('fieldset')\n      const button = form.querySelector('button')\n\n      fieldset.disabled = true\n      button.textContent = 'Updating Profile...'\n\n      try {\n        await updateProfileData(username, updatedData) // Corrected function call\n        handleAlert('Profile updated successfully!', 'success')\n        setTimeout(() => (window.location.pathname = '/profile/'), 2000)\n      } catch (updateError) {\n        handleAlert('Failed to update profile. Please try again', 'error')\n      }\n    })\n  } catch (error) {\n    console.error('Error fetching current profile data:', error)\n  } finally {\n    hideSkeletonLoader()\n    fieldset.disabled = false\n    button.textContent = originalButtonText\n  }\n}\n\nconst bioInput = document.getElementById('bio')\nconst charCount = document.getElementById('char-count')\n\nbioInput.addEventListener('input', () => {\n  const length = bioInput.value.length\n  charCount.textContent = `${length} / 160`\n})\n\nhandleProfileUpdate()\n"],"names":["authGuard","handleProfileUpdate","username","updateProfileContainer","profileImageContainer","bioField","imageUrlField","showSkeletonLoader","profile","fetchProfileData","profileImage","form","event","updatedData","fieldset","button","updateProfileData","handleAlert","error","hideSkeletonLoader","bioInput","charCount","length"],"mappings":"8NAQAA,EAAS,EAiBT,eAAeC,GAAsB,CAEnC,MAAMC,EADW,KAAK,MAAM,aAAa,QAAQ,MAAM,CAAC,GAC7B,KAErBC,EAAyB,SAAS,eACtC,wBACJ,EACEA,EAAuB,UAAU,IAAI,QAAQ,EAE7C,MAAMC,EAAwB,SAAS,eAAe,eAAe,EAC/DC,EAAW,SAAS,eAAe,KAAK,EACxCC,EAAgB,SAAS,eAAe,WAAW,EAEzD,GAAI,CACFC,EAAkB,EAClB,MAAMC,EAAU,MAAMC,EAAiBP,CAAQ,EAI/C,GAFAG,EAAS,MAAQG,GAAS,KAAO,mBAE7BA,GAAS,QAAQ,IAAK,CACxB,MAAME,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,IAAMF,EAAQ,OAAO,IAClCE,EAAa,IAAMF,EAAQ,OAAO,KAAO,gBACzCE,EAAa,UAAU,IAAI,SAAU,gBAAiB,cAAc,EACpEN,EAAsB,YAAYM,CAAY,EAE9CJ,EAAc,MAAQE,EAAQ,OAAO,GAC3C,CAEIL,EAAuB,UAAU,OAAO,QAAQ,EAEhD,MAAMQ,EAAO,SAAS,eAAe,mBAAmB,EACxDA,EAAK,iBAAiB,SAAU,MAAOC,GAAU,CAC/CA,EAAM,eAAc,EAEpB,MAAMC,EAAc,CAClB,IAAKR,EAAS,MACd,OAAQ,CACN,IAAKC,EAAc,MACnB,IAAK,eACN,CACT,EAEYQ,EAAWH,EAAK,cAAc,UAAU,EACxCI,EAASJ,EAAK,cAAc,QAAQ,EAE1CG,EAAS,SAAW,GACpBC,EAAO,YAAc,sBAErB,GAAI,CACF,MAAMC,EAAkBd,EAAUW,CAAW,EAC7CI,EAAY,gCAAiC,SAAS,EACtD,WAAW,IAAO,OAAO,SAAS,SAAW,YAAc,GAAI,CAChE,MAAqB,CACpBA,EAAY,6CAA8C,OAAO,CACzE,CACK,CAAA,CACF,OAAQC,EAAO,CACd,QAAQ,MAAM,uCAAwCA,CAAK,CAC/D,QAAY,CACRC,EAAkB,EAClB,SAAS,SAAW,GACpB,OAAO,YAAc,kBACzB,CACA,CAEA,MAAMC,EAAW,SAAS,eAAe,KAAK,EACxCC,EAAY,SAAS,eAAe,YAAY,EAEtDD,EAAS,iBAAiB,QAAS,IAAM,CACvC,MAAME,EAASF,EAAS,MAAM,OAC9BC,EAAU,YAAc,GAAGC,CAAM,QACnC,CAAC,EAEDrB,EAAmB"}