{"version":3,"file":"listingsSearchResult-CQhRSLdb.js","sources":["../../src/script/router/views/listingsSearchResult.mjs"],"sourcesContent":["import { fetchListingsBySearch } from '../../api/listings.mjs'\nimport { setUpSearch } from '../../utils/searchListings.mjs'\nimport {\n  showSkeletonLoader,\n  hideSkeletonLoader,\n} from '../../utils/skeletonLoader.mjs'\n\nsetUpSearch('#search-input', '#search-button')\n\n/**\n * Displays the search results based on the query parameter in the URL.\n *\n * This function retrieves the search query from the URL and fetches the listings that match the search query.\n * It then dynamically displays the search query and the corresponding search results in the `#search-query` and `#search-results` elements.\n * If no results are found, it will display a message indicating that no listings were found.\n *\n * @async\n * @returns {Promise<void>} - A promise that resolves when the search results have been displayed.\n *\n * @example\n * // This will display the search results for the query in the URL.\n * displaySearchResults();\n */\nasync function displaySearchResults() {\n  const urlParams = new URLSearchParams(window.location.search)\n  const query = urlParams.get('q')\n\n  showSkeletonLoader()\n\n  if (query) {\n    const searchQueryDiv = document.getElementById('search-query')\n    const searchHeading = document.createElement('h1')\n    searchHeading.textContent = `Search results for: ${query}`\n    searchHeading.classList.add('font-largeFont', 'text-4xl')\n    searchQueryDiv.appendChild(searchHeading)\n  } else {\n    return\n  }\n  const listings = await fetchListingsBySearch(query)\n  const searchResultsDiv = document.getElementById('search-results')\n  while (searchResultsDiv.firstChild) {\n    searchResultsDiv.removeChild(searchResultsDiv.firstChild)\n  }\n\n  if (listings.length === 0) {\n    const noResultsMessage = document.createElement('p')\n    noResultsMessage.textContent = 'No listings found for your search.'\n    searchResultsDiv.appendChild(noResultsMessage)\n  } else {\n    displaySearchListings(listings)\n    hideSkeletonLoader()\n  }\n}\n\n/**\n * Displays the listings returned from a search query.\n *\n * This function creates HTML elements for each listing and appends them to the `#search-results` element.\n * It displays information such as the listing's title, description, deadline, current bid, and tags.\n * Additionally, it handles the display of listings' images and the active/expired status based on the `endsAt` date.\n *\n * @param {Array} listings - The list of listings to display. Each listing should have `id`, `title`, `description`, `media`, `endsAt`, `bids`, and `tags` properties.\n * @returns {void} - This function does not return any value.\n *\n * @example\n * // This will display the listings passed to it.\n * displaySearchListings(listings);\n */\nasync function displaySearchListings(listings) {\n  const searchResultsDiv = document.getElementById('search-results')\n  listings.forEach((listing) => {\n    const listingDiv = document.createElement('a')\n    listingDiv.href = `/listings/view/index.html?id=${listing.id}`\n    listingDiv.classList.add(\n      'listing-item',\n      'border',\n      'p-4',\n      'shadow-2xl',\n      'bg-white',\n      'flex',\n      'flex-col',\n      'justify-between',\n      'min-h-[300px]',\n      'cursor-pointer',\n      'transition',\n      'duration-300',\n      'ease-out',\n      'hover:scale-105',\n      'rounded-lg',\n    )\n\n    const listingImage = document.createElement('img')\n    listingImage.src =\n      listing.media && listing.media[0]\n        ? listing.media[0].url\n        : '/assets/default-listing-image.png'\n    listingImage.alt = listing.title\n    listingImage.classList.add('w-full', 'h-48', 'object-cover', 'rounded-t-lg')\n\n    const listingTitle = document.createElement('h3')\n    listingTitle.textContent = listing.title\n    listingTitle.classList.add('text-lg', 'font-semibold', 'mt-2')\n\n    const listingDescription = document.createElement('p')\n    const descriptionLabel = document.createElement('span')\n    descriptionLabel.textContent =\n      listing.description.slice(0, 100) + '...' || 'No description added.'\n    descriptionLabel.classList.add('italic', 'text-sm', 'text-gray-600', 'mt-1')\n\n    listingDescription.append(descriptionLabel)\n\n    const listingDeadline = document.createElement('p')\n    const deadlineLabel = document.createElement('span')\n    deadlineLabel.textContent = 'Deadline: '\n    deadlineLabel.classList.add('font-bold')\n\n    const deadlineValue = document.createElement('span')\n    deadlineValue.textContent = new Date(listing.endsAt).toLocaleDateString()\n    deadlineValue.classList.add('font-normal')\n\n    listingDeadline.classList.add('text-sm', 'text-gray-600', 'mt-1')\n    listingDeadline.append(deadlineLabel, deadlineValue)\n\n    const listingBid = document.createElement('p')\n    const bidLabel = document.createElement('span')\n    bidLabel.textContent = 'Current Bid: '\n    bidLabel.classList.add('font-bold')\n\n    if (listing._count?.bids > 0) {\n      // This will show if there are bids\n      const currentBidValue = document.createElement('span')\n      currentBidValue.textContent = `$${listing.bids[listing.bids.length - 1].amount}`\n      currentBidValue.classList.add('font-normal')\n\n      listingBid.classList.add('text-sm', 'text-gray-600', 'mt-1')\n      listingBid.append(bidLabel, currentBidValue)\n    } else {\n      // This will show if there are no bids\n      const noBidsValue = document.createElement('span')\n      noBidsValue.textContent = 'No bids yet'\n      noBidsValue.classList.add('font-normal')\n\n      listingBid.classList.add('text-sm', 'text-gray-600', 'mt-1')\n      listingBid.append(bidLabel, noBidsValue)\n    }\n\n    const tagsDiv = document.createElement('div')\n    tagsDiv.classList.add('flex', 'flex-wrap', 'gap-1', 'mt-5', 'space-x-2')\n\n    if (listing.tags && listing.tags.length > 0) {\n      listing.tags.forEach((tag) => {\n        const tagElement = document.createElement('span')\n        tagElement.textContent = tag\n        tagElement.classList.add(\n          'rounded-full',\n          'bg-brand-dark',\n          'text-white',\n          'text-xs',\n          'px-3',\n          'py-1.5',\n        )\n        tagsDiv.appendChild(tagElement)\n      })\n    }\n\n    const currentDate = new Date()\n    const endAtDate = new Date(listing.endsAt)\n    const status = endAtDate > currentDate ? 'active' : 'expired'\n    const statusElement = document.createElement('span')\n    statusElement.textContent = status\n    statusElement.classList.add(\n      'rounded-full',\n      'text-white',\n      'text-xs',\n      'px-3',\n      'py-1.5',\n      status === 'active' ? 'bg-accent-dark' : 'bg-accent-light',\n    )\n    tagsDiv.appendChild(statusElement)\n\n    listingDiv.appendChild(listingImage)\n    listingDiv.appendChild(listingTitle)\n    listingDiv.appendChild(listingDescription)\n    listingDiv.appendChild(listingDeadline)\n    listingDiv.appendChild(listingBid)\n    listingDiv.appendChild(tagsDiv)\n\n    searchResultsDiv.appendChild(listingDiv)\n  })\n}\n\ndisplaySearchResults()\n"],"names":["setUpSearch","displaySearchResults","query","showSkeletonLoader","searchQueryDiv","searchHeading","listings","fetchListingsBySearch","searchResultsDiv","noResultsMessage","displaySearchListings","hideSkeletonLoader","listing","listingDiv","listingImage","listingTitle","listingDescription","descriptionLabel","listingDeadline","deadlineLabel","deadlineValue","listingBid","bidLabel","currentBidValue","noBidsValue","tagsDiv","tag","tagElement","currentDate","status","statusElement"],"mappings":"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"}